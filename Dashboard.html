<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Doctor Dashboard</title>

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f8f9fa;
        }

        header {
            background-color: #28a745;
            color: white;
            padding: 20px;
            text-align: center;
            font-size: 1.8rem;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .card-header {
            background-color: #007bff;
            color: white;
            text-align: center;
        }

        .dashboard-section {
            margin-top: 30px;
        }

        .card {
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .card-body {
            padding: 20px;
        }

        .widget-status {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px;
            background-color: #f8f9fa;
            border-radius: 5px;
            margin-bottom: 10px;
        }

        .status-active {
            color: green;
        }

        .status-completed {
            color: gray;
        }

        .badge-cancelled {
            background-color: red;
        }
    </style>
</head>
<body>

    <!-- Header -->
    <header>
        Doctor Dashboard
    </header>

    <div class="container dashboard-section">
        <div class="row">
            <!-- Patients List -->
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h4><i class="fas fa-users"></i> Patients List</h4>
                    </div>
                    <div class="card-body">
                        <ul class="list-group" id="patientsList">
                            <!-- Patients will be loaded here from data.json -->
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Group Session List -->
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h4><i class="fas fa-comments"></i> Group Sessions</h4>
                    </div>
                    <div class="card-body">
                        <ul class="list-group" id="sessionsList">
                            <!-- Group sessions will be loaded here from data.json -->
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <div class="container dashboard-section">
            <!-- Session Widget -->
            <div class="row">
                <div class="col-md-12">
                    <div class="card">
                        <div class="card-header">
                            <h4><i class="fas fa-clock"></i> Session Widget</h4>
                        </div>
                        <div class="card-body" id="sessionWidget">
                            <!-- Session widget content will be loaded here dynamically -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    
    </div>

    <!-- Bootstrap and FontAwesome JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/js/all.min.js"></script>

    <script>
        // Fetch data from Data.json and load it into the patients and group sessions list
        fetch('Data.json')
            .then(response => response.json())
            .then(dataArray => {
                // Since the data is an array of objects (patients and groupSessions), iterate over them
                dataArray.forEach(data => {
                    if (data.patients) {
                        const patients = data.patients;
                        const patientsList = document.getElementById('patientsList');
                        
                        // Iterate over each patient and create an HTML list item
                        patients.forEach(patient => {
                            const li = document.createElement('li');
                            li.className = 'list-group-item d-flex justify-content-between align-items-center';
                            li.setAttribute('data-id', patient.patient_id); // Store the patient ID in data-id attribute
                            li.innerHTML = `
                                ${patient.name}
                            `;
                            li.addEventListener('click', () => {
                                // Store patient data in localStorage
                                localStorage.setItem('selectedPatient', JSON.stringify(patient));
                                // Open patient record page in a new tab
                                window.open('PatientsData.html', '_blank');
                            });
                            patientsList.appendChild(li);
                        });
                    }

                    // Handle group sessions data
                    if (data.groupSessions) {
                        const groupSessions = data.groupSessions;
                        const sessionsList = document.getElementById('sessionsList');
                        
                        // Iterate over each session and create an HTML list item
                        groupSessions.forEach(session => {
                            const li = document.createElement('li');
                            li.className = 'list-group-item d-flex justify-content-between align-items-center';
                            li.setAttribute('data-id', session.session_id); // Store the session ID in data-id attribute
                            
                            // Add badge for session status
                            let statusBadge = '';
                            switch (session.session_status.toLowerCase()) {
                                case 'ongoing':
                                    statusBadge = '<span class="badge bg-success rounded-pill">Ongoing</span>';
                                    break;
                                case 'scheduled':
                                    statusBadge = '<span class="badge bg-warning rounded-pill">Scheduled</span>';
                                    break;
                                case 'completed':
                                    statusBadge = '<span class="badge bg-secondary rounded-pill">Completed</span>';
                                    break;
                                case 'cancelled':
                                    statusBadge = '<span class="badge bg-danger rounded-pill">Cancelled</span>';
                                    break;
                                default:
                                    statusBadge = '<span class="badge bg-light rounded-pill">Unknown</span>';
                                    break;
                            }

                            li.innerHTML = `
                                ${session.session_name} ${statusBadge}
                            `;

                            li.addEventListener('click', () => {
                                // Store session data in localStorage
                                localStorage.setItem('selectedSession', JSON.stringify(session));
                                // Open session details page in a new tab
                                window.open('GroupSession.html', '_blank');
                            });
                            sessionsList.appendChild(li);
                        });
                    }

                    if (data.sessions) {
                const sessionWidget = document.getElementById('sessionWidget');
                data.sessions.forEach(session => {
                    const widget = document.createElement('div');
                    widget.className = 'widget-status';
                    
                    // Add session name and state (In Progress, Completed, etc.)
                    let statusClass;
                    let statusIcon;
                    switch (session.session_state.toLowerCase()) {
                        case 'in progress':
                            statusClass = 'status-active';
                            statusIcon = 'fa-circle';
                            break;
                        case 'completed':
                            statusClass = 'status-completed';
                            statusIcon = 'fa-check-circle';
                            break;
                        case 'scheduled':
                            statusClass = 'status-scheduled';
                            statusIcon = 'fa-calendar-alt';
                            break;
                        case 'cancelled':
                            statusClass = 'status-cancelled';
                            statusIcon = 'fa-times-circle';
                            break;
                        default:
                            statusClass = 'status-scheduled';
                            statusIcon = 'fa-question-circle';
                    }

                    widget.innerHTML = `
                        <div>${session.session_name}</div>
                        <div class="${statusClass}">
                            <i class="fas ${statusIcon}"></i> ${session.session_state}
                        </div>
                    `;

                    // Add click event to open the session details in a new tab
                    widget.addEventListener('click', () => {
                        // Store the clicked session in localStorage
                        localStorage.setItem('selectedSession', JSON.stringify(session));
                        // Open the session details page in a new tab
                        window.open('Session.html', '_blank');
                    });

                    sessionWidget.appendChild(widget);
                });
            }
                });
            })
            .catch(error => console.error('Error loading data:', error));

           
    </script>
</body>
</html>
